System.register("chunks:///_virtual/CameraController.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(e){var o,i,n,t,r,a,l,s,c,p,u,h;return{setters:[function(e){o=e.applyDecoratedDescriptor,i=e.inheritsLoose,n=e.initializerDefineProperty,t=e.assertThisInitialized},function(e){r=e.cclegacy,a=e._decorator,l=e.Node,s=e.Camera,c=e.Vec3,p=e.tween,u=e.math,h=e.Component}],execute:function(){var d,m,y,f,g,w,b,C;r._RF.push({},"b460e9Fwo5KqrwT8fDomeBa","CameraController",void 0);var P=a.ccclass,v=a.property;e("CameraController",(d=P("CameraController"),m=v(l),y=v(s),d((w=o((g=function(e){function o(){for(var o,i=arguments.length,r=new Array(i),a=0;a<i;a++)r[a]=arguments[a];return o=e.call.apply(e,[this].concat(r))||this,n(o,"player",w,t(o)),n(o,"camera",b,t(o)),n(o,"smoothSpeed",C,t(o)),o.isShaking=!1,o.originalPosition=new c,o}i(o,e);var r=o.prototype;return r.update=function(e){this.player&&!this.isShaking&&this.followPlayer(e)},r.followPlayer=function(e){var o=this.player.worldPosition.clone();o.y=this.node.worldPosition.y,this.node.worldPosition=this.node.worldPosition.lerp(o,e*this.smoothSpeed)},r.shakeCamera=function(){var e=this;this.isShaking||(this.isShaking=!0,this.originalPosition.set(this.node.position),p(this.node).by(.05,{position:new c(u.randomRange(-.3,.3),u.randomRange(-.3,.3),0)}).by(.05,{position:new c(u.randomRange(-.3,.3),u.randomRange(-.3,.3),0)}).by(.05,{position:new c(u.randomRange(-.3,.3),u.randomRange(-.3,.3),0)}).to(.05,{position:this.originalPosition}).call((function(){e.isShaking=!1})).start())},o}(h)).prototype,"player",[m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),b=o(g.prototype,"camera",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),C=o(g.prototype,"smoothSpeed",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 7}}),f=g))||f));r._RF.pop()}}}));

System.register("chunks:///_virtual/CollisionCheck.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Enemy.ts"],(function(e){var n,o,t,i,r,s;return{setters:[function(e){n=e.inheritsLoose},function(e){o=e.cclegacy,t=e._decorator,i=e.Collider,r=e.Component},function(e){s=e.Enemy}],execute:function(){var c;o._RF.push({},"4375ahq17hIy7i0eIEuUDOi","CollisionCheck",void 0);var l=t.ccclass;t.property,e("CollisionCheck",l("CollisionCheck")(c=function(e){function o(){return e.apply(this,arguments)||this}n(o,e);var t=o.prototype;return t.onLoad=function(){var e=this.getComponent(i);e&&e.on("onTriggerEnter",this.onTriggerEnter,this)},t.onTriggerEnter=function(e){var n=e.otherCollider.node;if(n.name.includes("Enemy")){console.log("Ghost collided with enemy:",n.name);var o=n.getComponent(s);o&&(this.node.name.includes("Ghost")?o.takeDamage(20):o.takeDamage(100))}},o}(r))||c);o._RF.pop()}}}));

System.register("chunks:///_virtual/Enemy.ts",["./rollupPluginModLoBabelHelpers.js","cc","./GameController.ts"],(function(e){var t,n,a,i,o,r,l,s,c,u,d,m,h,p,f,y,g,v;return{setters:[function(e){t=e.applyDecoratedDescriptor,n=e.inheritsLoose,a=e.initializerDefineProperty,i=e.assertThisInitialized},function(e){o=e.cclegacy,r=e._decorator,l=e.Prefab,s=e.director,c=e.Camera,u=e.Vec3,d=e.find,m=e.instantiate,h=e.Label,p=e.UITransform,f=e.tween,y=e.SkeletalAnimation,g=e.Component},function(e){v=e.GameController}],execute:function(){var b,w,D,P,C,A,R,k;o._RF.push({},"8276f0QAglHMYv1XklowuyU","Enemy",void 0);var T=r.ccclass,_=r.property;e("Enemy",(b=T("Enemy"),w=_(l),b((C=t((P=function(e){function t(){for(var t,n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];return t=e.call.apply(e,[this].concat(o))||this,a(t,"speed",C,i(t)),a(t,"attackRange",A,i(t)),a(t,"health",R,i(t)),t.player=null,t.isDead=!1,t.currentAnimation="",t.lastDamageTime=0,t.damageCooldown=.5,a(t,"damageNumber",k,i(t)),t}n(t,e);var o=t.prototype;return o.onLoad=function(){var e;this.player=(null==(e=v.getInstance())?void 0:e.player)||null},o.update=function(e){if(!this.isDead&&this.player){var t=this.player.worldPosition.clone().subtract(this.node.worldPosition),n=t.length();n<.1||(n>this.attackRange?(this.moveToPlayer(t.normalize(),e),this.playAnimation("B_Pelvis|B_Pelvis|Worker_Walk|Animation Base Layer")):this.playAnimation("B_Pelvis|B_Pelvis|Worker_Attack|Animation Base Layer"))}},o.updateDamageText=function(e){var t,n=null==(t=s.getScene())||null==(t=t.getChildByName("Main Camera"))?void 0:t.getComponent(c);if(n){var a=this.node.getWorldPosition(),i=new u;n.worldToScreen(a,i);var o=d("Canvas/RenderRoot2D");if(o){var r=m(this.damageNumber);r.getComponent(h).string="-"+e;var l=o.getComponent(p);if(l){var y=new u;l.convertToNodeSpaceAR(new u(i.x,i.y,0),y),r.setPosition(y),o.addChild(r),r.active=!0,f(r).by(.5,{position:new u(0,50,0)}).call((function(){return r.destroy()})).start()}else console.warn("UITransform component missing on RenderRoot2D!")}else console.warn("RenderRoot2D not found!")}else console.warn("Main Camera not found!")},o.moveToPlayer=function(e,t){this.node.setPosition(this.node.worldPosition.add(e.multiplyScalar(this.speed*t)));var n=Math.atan2(e.x,e.z)*(180/Math.PI);this.node.setRotationFromEuler(0,n,0)},o.takeDamage=function(e){if(!this.isDead){var t=Date.now()/1e3;t-this.lastDamageTime<this.damageCooldown||(this.lastDamageTime=t,console.log("Enemy taking damage: "+e+", Health before: "+this.health),this.health-=e,this.health<=0&&this.die())}},o.die=function(){var e=this;this.isDead||(this.isDead=!0,console.log("Enemy died!"),this.scheduleOnce((function(){var t;e.node.active=!1,null==(t=v.getInstance())||t.recycleEnemy(e)}),1.5))},o.playAnimation=function(e){var t=this.node.getComponent(y);t&&this.currentAnimation!==e&&(this.currentAnimation=e,t.play(e))},t}(g)).prototype,"speed",[_],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 2}}),A=t(P.prototype,"attackRange",[_],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 2}}),R=t(P.prototype,"health",[_],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 100}}),k=t(P.prototype,"damageNumber",[w],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),D=P))||D));o._RF.pop()}}}));

System.register("chunks:///_virtual/FaceCamera.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(e){var t,r,a,n;return{setters:[function(e){t=e.inheritsLoose},function(e){r=e.cclegacy,a=e._decorator,n=e.Component}],execute:function(){var c;r._RF.push({},"48960J0VOxAi4obyj0rdEtj","FaceCamera",void 0);var o=a.ccclass;a.property,e("FaceCamera",o("FaceCamera")(c=function(e){function r(){return e.apply(this,arguments)||this}t(r,e);var a=r.prototype;return a.start=function(){},a.update=function(e){},r}(n))||c);r._RF.pop()}}}));

System.register("chunks:///_virtual/GameController.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Enemy.ts","./CameraController.ts"],(function(t){var e,i,n,o,r,a,s,l,u,c,h,p,f,m,b,d,g,y;return{setters:[function(t){e=t.applyDecoratedDescriptor,i=t.inheritsLoose,n=t.initializerDefineProperty,o=t.assertThisInitialized},function(t){r=t.cclegacy,a=t._decorator,s=t.Prefab,l=t.Node,u=t.Label,c=t.Quat,h=t.instantiate,p=t.Vec3,f=t.UIOpacity,m=t.tween,b=t.sys,d=t.Component},function(t){g=t.Enemy},function(t){y=t.CameraController}],execute:function(){var w,C,v,P,E,z,G,k,S,I,R,x,L,M,_,O,D,K,U,W,F,A,B,N,Y,j,q,H,Q,T;r._RF.push({},"4e29740LB9AXafEcLIKfzOf","GameController",void 0);var V=a.ccclass,X=a.property;t("GameController",(w=V("GameController"),C=X(s),v=X([l]),P=X(l),E=X(l),z=X(u),G=X(u),k=X(s),S=X(l),I=X({tooltip:"Max enemies allowed in the pool"}),R=X({tooltip:"Ghost orbit radius"}),x=X({tooltip:"Ghost rotation speed (degrees per second)"}),L=X(s),M=X(y),w(((T=function(t){function e(){for(var e,i=arguments.length,r=new Array(i),a=0;a<i;a++)r[a]=arguments[a];return e=t.call.apply(t,[this].concat(r))||this,n(e,"enemyPrefab",D,o(e)),n(e,"spawnPoints",K,o(e)),n(e,"player",U,o(e)),n(e,"winScreen",W,o(e)),n(e,"statusLabel",F,o(e)),n(e,"killCounter",A,o(e)),n(e,"ghostPrefab",B,o(e)),n(e,"orbitRoot",N,o(e)),n(e,"maxEnemies",Y,o(e)),n(e,"ghostRadius",j,o(e)),n(e,"ghostSpeed",q,o(e)),n(e,"puffFx",H,o(e)),n(e,"cameraMainController",Q,o(e)),e.enemyPool=[],e.activeEnemies=[],e.killCount=0,e.isGameOver=!1,e.ghostCount=1,e.spawnIndex=0,e.minSpawnDistance=2,e}i(e,t);var r=e.prototype;return r.onLoad=function(){e._instance?this.destroy():(e._instance=this,this.winScreen.active=!1,this.resetUI())},e.getInstance=function(){return e._instance},r.start=function(){this.initializeEnemies(),this.startGame()},r.update=function(t){if(this.orbitRoot){var e=new c;c.fromEuler(e,0,this.ghostSpeed*t,0),this.orbitRoot.rotate(e)}},r.initializeEnemies=function(){for(var t=0;t<this.maxEnemies;t++){var e=h(this.enemyPrefab),i=e.getComponent(g);i&&(e.active=!1,this.enemyPool.push(i),this.node.addChild(e))}},r.spawnEnemy=function(){if(this.enemyPool.length>0&&this.spawnPoints.length>0){var t=this.enemyPool.pop();if(t){var e=Math.floor(Math.random()*this.spawnPoints.length),i=this.spawnPoints[e].getWorldPosition();t.node.setPosition(i),t.node.active=!0,this.activeEnemies.push(t),this.spawnIndex=(this.spawnIndex+1)%this.spawnPoints.length}}},r.recycleEnemy=function(t){this.isGameOver||(t.node.active=!1,this.activeEnemies=this.activeEnemies.filter((function(e){return e!==t})),this.enemyPool.push(t),this.killCount++,10!==this.killCount&&20!==this.killCount||this.spawnGhost(),this.killCount>=30&&this.showWinScreen("You Win!"),this.updateKillCounter())},r.spawnGhost=function(){if(this.ghostPrefab&&this.orbitRoot){var t=this.ghostCount/3*Math.PI*2,e=new p(this.ghostRadius*Math.cos(t),0,this.ghostRadius*Math.sin(t)),i=h(this.ghostPrefab);i.setPosition(e),this.orbitRoot.addChild(i),this.ghostCount++}},r.playerDied=function(){this.isGameOver||this.showWinScreen("You Died!")},r.showWinScreen=function(t){this.isGameOver=!0,this.statusLabel.string=t,this.fadeIn(this.winScreen)},r.fadeIn=function(t){t.active=!0;var e=t.getComponent(f)||t.addComponent(f);e.opacity=0,m(e).to(.5,{opacity:255}).start()},r.openPlayStore=function(){b.openURL("https://play.google.com/store/apps/details?id=com.quicksand.pocketnecromancer&hl=en_IN")},r.startGame=function(){this.resetGameState(),this.schedule(this.spawnEnemy,1.5),this.spawnGhost()},r.resetGameState=function(){this.isGameOver=!1,this.killCount=0,this.ghostCount=1,this.spawnIndex=0,this.activeEnemies.forEach((function(t){return t.node.active=!1})),this.activeEnemies=[],this.resetUI()},r.resetUI=function(){this.winScreen.active=!1,this.killCounter.string="Kill them all",this.killCounter.node.setPosition(new p(0,300,0))},r.updateKillCounter=function(){this.killCounter.string="Kills: "+this.killCount,this.killCounter.node.setPosition(new p(0,600,0))},e}(d))._instance=null,D=e((O=T).prototype,"enemyPrefab",[C],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),K=e(O.prototype,"spawnPoints",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),U=e(O.prototype,"player",[P],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),W=e(O.prototype,"winScreen",[E],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),F=e(O.prototype,"statusLabel",[z],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),A=e(O.prototype,"killCounter",[G],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),B=e(O.prototype,"ghostPrefab",[k],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),N=e(O.prototype,"orbitRoot",[S],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Y=e(O.prototype,"maxEnemies",[I],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 10}}),j=e(O.prototype,"ghostRadius",[R],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 3}}),q=e(O.prototype,"ghostSpeed",[x],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 50}}),H=e(O.prototype,"puffFx",[L],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Q=e(O.prototype,"cameraMainController",[M],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),_=O))||_));r._RF.pop()}}}));

System.register("chunks:///_virtual/Joystick.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){var i,n,o,e,r,s,c,a,u,l,h;return{setters:[function(t){i=t.applyDecoratedDescriptor,n=t.inheritsLoose,o=t.initializerDefineProperty,e=t.assertThisInitialized},function(t){r=t.cclegacy,s=t._decorator,c=t.Node,a=t.Vec3,u=t.Input,l=t.UITransform,h=t.Component}],execute:function(){var p,y,g,d,f,T,v,k,j;r._RF.push({},"ef93576FqJGp4Bp1vidms4+","Joystick",void 0);var m=s.ccclass,E=s.property;t("Joystick",(p=m("Joystick"),y=E(c),g=E(c),d=E(Number),p((v=i((T=function(t){function i(){for(var i,n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return i=t.call.apply(t,[this].concat(r))||this,o(i,"joystickBg",v,e(i)),o(i,"joystickHandle",k,e(i)),o(i,"radius",j,e(i)),i.direction=new a(0,0,0),i.isDragging=!1,i}n(i,t);var r=i.prototype;return r.start=function(){this.joystickBg.on(u.EventType.TOUCH_START,this.onTouchStart,this),this.joystickBg.on(u.EventType.TOUCH_MOVE,this.onTouchMove,this),this.joystickBg.on(u.EventType.TOUCH_END,this.onTouchEnd,this),this.joystickBg.on(u.EventType.TOUCH_CANCEL,this.onTouchEnd,this)},r.onTouchStart=function(t){var i=t.getUILocation(),n=this.node.getComponent(l).convertToNodeSpaceAR(new a(i.x,i.y,0));this.joystickBg.setPosition(n),this.joystickHandle.setPosition(a.ZERO),this.isDragging=!0},r.onTouchMove=function(t){var i=t.getUILocation(),n=this.node.getComponent(l).convertToNodeSpaceAR(new a(i.x,i.y,0)),o=n.clone().normalize(),e=Math.min(n.length(),this.radius),r=o.multiplyScalar(e);this.joystickHandle.setPosition(r),this.direction.set(o)},r.onTouchEnd=function(){this.joystickHandle.setPosition(a.ZERO),this.direction.set(a.ZERO),this.isDragging=!1},r.getDirection=function(){return this.direction},i}(h)).prototype,"joystickBg",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),k=i(T.prototype,"joystickHandle",[g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),j=i(T.prototype,"radius",[d],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 100}}),f=T))||f));r._RF.pop()}}}));

System.register("chunks:///_virtual/main",["./CameraController.ts","./CollisionCheck.ts","./Enemy.ts","./FaceCamera.ts","./GameController.ts","./Joystick.ts","./PlayerController.ts"],(function(){return{setters:[null,null,null,null,null,null,null],execute:function(){}}}));

System.register("chunks:///_virtual/PlayerController.ts",["./rollupPluginModLoBabelHelpers.js","cc","./GameController.ts","./Joystick.ts"],(function(t){var e,i,n,a,o,s,r,l,c,h,u,p,m,y,d,k,f,A;return{setters:[function(t){e=t.applyDecoratedDescriptor,i=t.inheritsLoose,n=t.initializerDefineProperty,a=t.assertThisInitialized},function(t){o=t.cclegacy,s=t._decorator,r=t.SkeletalAnimation,l=t.Node,c=t.CCFloat,h=t.ProgressBar,u=t.Vec3,p=t.input,m=t.Input,y=t.Collider,d=t.KeyCode,k=t.Component},function(t){f=t.GameController},function(t){A=t.Joystick}],execute:function(){var g,v,_,D,E,b,C,R,K,P,I,w,O;o._RF.push({},"3e666d1+bBIiIWfcBNK2Uxn","PlayerController",void 0);var W=s.ccclass,z=s.property;t("PlayerController",(g=W("PlayerController"),v=z(r),_=z(l),D=z({type:c}),E=z(h),b=z(A),g((K=e((R=function(t){function e(){for(var e,i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return e=t.call.apply(t,[this].concat(o))||this,n(e,"skeletalAnimationComponent",K,a(e)),n(e,"attackFx",P,a(e)),n(e,"speed",I,a(e)),n(e,"progressBar",w,a(e)),n(e,"joystick",O,a(e)),e.movementInput=new u(0,0,0),e.isAttacking=!1,e.isDead=!1,e.health=100,e}i(e,t);var o=e.prototype;return o.onLoad=function(){p.on(m.EventType.KEY_DOWN,this.onKeyDown,this),p.on(m.EventType.KEY_UP,this.onKeyUp,this);var t=this.getComponent(y);t&&t.on("onTriggerEnter",this.onTriggerEnter,this),this.schedule(this.autoAttack,2+Math.random())},o.onDestroy=function(){p.off(m.EventType.KEY_DOWN,this.onKeyDown,this),p.off(m.EventType.KEY_UP,this.onKeyUp,this),this.unschedule(this.autoAttack)},o.onKeyDown=function(t){if(!this.isAttacking&&!this.isDead)switch(t.keyCode){case d.KEY_W:case d.ARROW_UP:this.movementInput.z=1;break;case d.KEY_S:case d.ARROW_DOWN:this.movementInput.z=-1;break;case d.KEY_A:case d.ARROW_LEFT:this.movementInput.x=-1;break;case d.KEY_D:case d.ARROW_RIGHT:this.movementInput.x=1;break;case d.SPACE:this.playAttackAnimation()}},o.onKeyUp=function(t){switch(t.keyCode){case d.KEY_W:case d.ARROW_UP:case d.KEY_S:case d.ARROW_DOWN:this.movementInput.z=0;break;case d.KEY_A:case d.ARROW_LEFT:case d.KEY_D:case d.ARROW_RIGHT:this.movementInput.x=0}},o.update=function(t){if(!this.isAttacking&&!this.isDead){var e=this.joystick?this.joystick.getDirection():new u(0,0,0);if(e.equals(u.ZERO)||this.movementInput.set(e),!this.movementInput.equals(u.ZERO)){var i=this.movementInput.normalize().multiplyScalar(this.speed*t);this.node.setPosition(this.node.position.add(i));var n=new u(-i.x,0,-i.z);this.node.forward=n,this.playMoveAnimation()}}},o.playMoveAnimation=function(){var t;this.isAttacking||!1!==(null==(t=this.skeletalAnimationComponent)||null==(t=t.getState("Player_Move"))?void 0:t.isPlaying)||this.skeletalAnimationComponent.play("Player_Move")},o.playAttackAnimation=function(){var t,e=this;if(!this.isAttacking&&!this.isDead){this.attackFx.active=!0,this.isAttacking=!0,this.skeletalAnimationComponent.play("Player_Attack");var i=(null==(t=this.skeletalAnimationComponent.getState("Player_Attack"))?void 0:t.duration)||.5;this.scheduleOnce((function(){e.isAttacking=!1,e.attackFx.active=!1}),i)}},o.autoAttack=function(){this.isAttacking||this.isDead||this.playAttackAnimation(),this.schedule(this.autoAttack,3+Math.random())},o.onTriggerEnter=function(t){"Pickaxe"===t.otherCollider.node.name&&this.takeDamage(1)},o.takeDamage=function(t){this.isDead||(this.health-=t,this.progressBar.progress=this.health/100,this.health<=0&&this.die())},o.die=function(){var t;this.isDead||(this.isDead=!0,console.log("Player died!"),null==(t=f.getInstance())||t.playerDied(),this.unschedule(this.autoAttack))},e}(k)).prototype,"skeletalAnimationComponent",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),P=e(R.prototype,"attackFx",[_],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),I=e(R.prototype,"speed",[D],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 5}}),w=e(R.prototype,"progressBar",[E],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),O=e(R.prototype,"joystick",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),C=R))||C));o._RF.pop()}}}));

(function(r) {
  r('virtual:///prerequisite-imports/main', 'chunks:///_virtual/main'); 
})(function(mid, cid) {
    System.register(mid, [cid], function (_export, _context) {
    return {
        setters: [function(_m) {
            var _exportObj = {};

            for (var _key in _m) {
              if (_key !== "default" && _key !== "__esModule") _exportObj[_key] = _m[_key];
            }
      
            _export(_exportObj);
        }],
        execute: function () { }
    };
    });
});